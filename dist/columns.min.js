!function(a){"use strict";a.zepto&&!a.fn.removeData&&console.log("Error: Zepto is loaded without the data module."),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||!1}(),a.fn.columns=function(b){function c(a,b){a.style.webkitTransform=b,a.style.MozTransform=b,a.style.msTransform=b,a.style.transform=b}function d(a,b){a.style.removeProperty?a.style.removeProperty(b):a.style.removeAttribute(b)}function e(b){b=b||{};var c=this,d={namespace:"columns",height:c.height(),width:c.width(),top:c.offset().top,left:c.offset().left,win:q.height(),winW:q.width(),gutterTop:0,cols:4,columnHeights:[],columnTemplate:'<div class="column">{{ content }}</div>',autoWidth:!0,createColumns:!0,proportionalScroll:!1,reverse:!1,reversedDirection:!1,requestFrame:!0,destroyed:!1},e=c.children(),k=e.length,l=0,n=[],o=0,r="";if(b.filter=b.filter||!1,a.extend(p,d,b),p.createColumns){for(p.oldHTML=c[0].innerHTML,l=0;k>l;l++)n[o]=(n[o]||"")+e[l].outerHTML,o++,o===p.cols&&(o=0);for(l=0;l<p.cols;l++)n[l]=n[l]||"",r+=p.columnTemplate.replace("{{ content }}",n[l]);c.html(r),p.columns=c.find(".column")}else p.columns=c.children();return c.data("settings",p),window.requestAnimationFrame&&p.requestFrame?(q.on("scroll."+p.namespace,this,h).on("resize."+p.namespace,this,g).on("touchmove."+p.namespace,this,h).trigger("scroll").trigger("resize"),g(),h(),i(),j=requestAnimFrame(f)):(q.on("scroll."+p.namespace,this,i).on("resize."+p.namespace,this,g).on("touchmove."+p.namespace,this,i).trigger("scroll").trigger("resize"),g(),i()),m=setTimeout(g,2e3),c}function f(){p.destroyed||(i(),j=requestAnimFrame(f))}function g(a){if(k.length){var b=k,c=0,d=0,e=0,f={left:0};if(p){for(p.width=b.width(),p.top=b.offset().top,p.left=b.offset().left,p.win=q.height(),p.winW=q.width(),p.autoWidth&&(f.width=p.width/p.cols+"px"),c=0;c<p.cols;c++)p.columns.eq(c).removeAttr("style").removeClass("is-fixed").removeClass("is-short"),f.marginLeft=e,p.columns.eq(c).css(f),p.columnHeights[c]=p.columns.eq(c).height()+p.gutterTop,d=Math.max(p.columnHeights[c],d),e+=p.columns.eq(c).width();b.height(d),p.height=d,b.data("settings",p),h.call(b,{data:[b]})}}}function h(){o=!0,clearTimeout(n),n=setTimeout(function(){o=!1})}function i(){var a=k,b=l.scrollY?window.scrollY:q.scrollTop(),e=0;if(p)if(p.proportionalScroll){var f=1,g=0,h="",i=0;for(e=0;e<p.cols;e++)f=p.columnHeights[e]/p.height,1!==f&&(g=(1-f)*p.height*Math.min(1,Math.max(0,(b-p.top)/(p.height-p.win))),g=Math.round(g),h="translate3d(0px,"+g+"px, 0px)",(b-p.top)/(p.height-p.win)>1&&(h="none",i=g),p.columns.eq(e).get(0).style.top=i+"px",c(p.columns.eq(e).get(0),h))}else{if(b<p.top)return p.columns.removeClass("is-fixed").removeClass("is-top-fixed").removeClass("is-short").css({left:0,minHeight:0,top:p.gutterTop}),p.columns.each(function(a,b){d(b,"position")}),void a.removeClass("is-scrolled-past");if(b+p.win>p.top+p.height){for(p.columns.removeClass("is-fixed").removeClass("is-top-fixed").css({left:0,transform:"none","-webkit-transform":"none","-moz-transform":"none","-ms-transform":"none"}),e=0;e<p.cols;e++)p.columnHeights[e]<p.win&&p.columnHeights[e]<p.height&&(b+p.columnHeights[e]>p.top+p.height?p.columns.eq(e).css({top:"auto",bottom:0,position:"absolute"}):p.columns.eq(e).css({position:"fixed",top:p.gutterTop,left:p.left}));return void a.addClass("is-scrolled-past")}if(a.removeClass("is-scrolled-past"),p.reverse)for(e=0;e<p.cols;e++)p.columnHeights[e]<p.win&&b>p.top?p.columns.eq(e).removeClass("is-bottom-fixed").addClass("is-short").css({left:p.left,top:0}):(p.columns.eq(e).removeClass("is-short").css({left:0,top:0}),b<p.top||(b>p.top+p.height-p.columnHeights[e]?p.columns.eq(e).removeClass("is-top-fixed").css({left:0,top:p.height-p.columnHeights[e]}):p.columnHeights[e]<p.height&&p.columns.eq(e).addClass("is-top-fixed").css({left:p.left})));else for(e=0;e<p.cols;e++)if(p.columnHeights[e]<p.win&&b>p.top)p.columns.eq(e).removeClass("is-fixed").addClass("is-short").css({left:p.left,transform:"none","-webkit-transform":"none","-moz-transform":"none","-ms-transform":"none",position:"fixed",top:p.gutterTop});else if(p.columns.eq(e).removeClass("is-short").css({left:0}),d(p.columns.eq(e).get(0),"position"),!(b<p.top))if(p.reversedDirection&&e%2!==0){var g=2*Math.max(b-p.top,0)+p.win-p.columnHeights[e];g=Math.round(g),g=Math.min(g,-p.win+p.height),h="translate3d(0px,"+g+"px, 0px)",c(columns.eq(e).get(0),h)}else b>p.top+p.columnHeights[e]+p.gutterTop-p.win?p.columns.eq(e).addClass("is-fixed").css({top:"auto",left:p.left}):p.columns.eq(e).removeClass("is-fixed").css({left:0})}}var j,k=this,l={scrollY:window.scrollY>=0?!0:!1},m=null,n=null,o=!1,p={},q=(a(document),a("body"),a(window)),r={destroy:function(){p=this.data("settings"),p&&(p.createColumns&&(this[0].innerHTML=p.oldHTML,this[0].setAttribute("style","")),q.off("."+p.namespace),a(this).removeData("settings"),clearTimeout(m),"cancelAnimationFrame"in window&&window.cancelAnimationFrame(j),p.destroyed=!0)},softDestroy:function(){p=this.data("settings"),p&&(q.off("."+p.namespace),a(this).removeData("settings"),clearTimeout(m),"cancelAnimationFrame"in window&&window.cancelAnimationFrame(j))},update:function(b,c){var d=a(this);p=p||d.data("settings")||{},p[b]=c,d.data("settings",p)}};if("string"==typeof b&&b in r)return r[b].call(this,arguments.length>1?arguments.slice(1):arguments),k;return e.call(this,b)}}(window.jQuery||window.Zepto);