!function(a){"use strict";a.zepto&&!a.fn.removeData&&console.log("Error: Zepto is loaded without the data module."),a.fn.columns=function(b){function c(b){b=b||{};var c=this,g={namespace:"columns",height:c.height(),width:c.width(),top:c.offset().top,left:c.offset().left,win:f.height(),winW:f.width(),cols:4,columnHeights:[],columnTemplate:'<div class="column">{{ content }}</div>',autoWidth:!0,createColumns:!0,proportionalScroll:!1,reverse:!1,reversedDirection:!1},h=c.children(),i=h.length,j=0,k=[],l=0,m="";if(b.filter=b.filter||!1,a.extend(g,b),g.createColumns){for(j=0;i>j;j++)k[l]=(k[l]||"")+h[j].outerHTML,l++,l===g.cols&&(l=0);for(j=0;j<g.cols;j++)m+=g.columnTemplate.replace("{{ content }}",k[j]);c.html(m),g.columns=c.find(".column")}else g.columns=c.children();return c.data("settings",g),f.on("scroll."+g.namespace,this,e).on("resize."+g.namespace,this,d).trigger("scroll").trigger("resize"),d({data:[this]}),e({data:[this]}),console.log(g),c}function d(b){var c=a(b.data[0]),d=c.data("settings"),g=0,h=0,i=0,j={left:0};for(console.log("resize called for "+d.namespace),d.width=c.width(),d.top=c.offset().top,d.left=c.offset().left,d.win=f.height(),d.winW=f.width(),d.autoWidth&&(j.width=d.width/d.cols+"px"),g=0;g<d.cols;g++)d.columns.eq(g).removeAttr("style").removeClass("is-fixed").removeClass("is-short"),j.marginLeft=i,d.columns.eq(g).css(j),d.columnHeights[g]=d.columns.eq(g).height(),h=Math.max(d.columnHeights[g],h),i+=d.columns.eq(g).width();c.height(h),d.height=c.height(),console.log(d),c.data("settings",d),e.call(c,{data:[c]})}function e(b){var c=a(b.data[0]),d=c.data("settings"),e=f.scrollTop(),g=0;if(d.proportionalScroll){var h=1,i=0,j="";for(g=0;g<d.cols;g++)h=d.columnHeights[g]/d.height,1!==h&&(i=(1-h)*d.height*Math.min(1,Math.max(0,(e-d.top)/(d.height-d.win))),j="translate3d(0px,"+i+"px, 0px)",d.columns.eq(g).css({transform:j,"-webkit-transform":j,"-moz-transform":j,"-ms-transform":j}))}else{if(e<d.top)return d.columns.removeClass("is-fixed").removeClass("is-top-fixed").removeClass("is-short").css({left:0,minHeight:0,top:0}),void c.removeClass("is-scrolled-past");if(e+d.win>d.top+d.height)return d.columns.removeClass("is-fixed").removeClass("is-top-fixed").css({left:0}),d.columns.filter(".is-short").css({minHeight:d.win}),void c.addClass("is-scrolled-past");if(c.removeClass("is-scrolled-past"),d.reverse)for(g=0;g<d.cols;g++)d.columnHeights[g]<d.win&&e>d.top?d.columns.eq(g).removeClass("is-bottom-fixed").addClass("is-short").css({left:d.left}):(d.columns.eq(g).removeClass("is-short").css({left:0,top:0}),e<d.top||(e>d.top+d.height-d.columnHeights[g]?d.columns.eq(g).removeClass("is-top-fixed").css({left:0,top:d.height-d.columnHeights[g]}):d.columnHeights[g]<d.height&&d.columns.eq(g).addClass("is-top-fixed").css({left:d.left})));else for(g=0;g<d.cols;g++)if(d.columnHeights[g]<d.win&&e>d.top)d.columns.eq(g).removeClass("is-fixed").addClass("is-short").css({left:d.left,transform:"none","-webkit-transform":"none","-moz-transform":"none","-ms-transform":"none"});else if(d.columns.eq(g).removeClass("is-short").css({left:0}),!(e<d.top))if(d.reversedDirection&&g%2!==0){var i=2*Math.max(e-d.top,0)+d.win-d.columnHeights[g];i=Math.min(i,-d.win+d.height),j="translate3d(0px,"+i+"px, 0px)",d.columns.eq(g).css({transform:j,"-webkit-transform":j,"-moz-transform":j,"-ms-transform":j})}else e>d.top+d.columnHeights[g]-d.win?d.columns.eq(g).addClass("is-fixed").css({top:"auto",left:d.left}):d.columns.eq(g).removeClass("is-fixed").css({left:0})}}var f=(a(document),a("body"),a(window)),g={destroy:function(){var b=this.data("settings");f.off(b.namespace),a(this).removeData("settings"),console.log("destroy called")},update:function(b,c){var d=a(this),e=d.data("settings")||{};e[b]=c,d.data("settings",e)}};return"string"==typeof b&&b in g?(g[b].call(this,arguments.length>1?arguments.slice(1):arguments),!1):c.call(this,b)}}(window.jQuery||window.Zepto);