!function(a){"use strict";a.zepto&&!a.fn.removeData&&console.log("Error: Zepto is loaded without the data module."),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||!1}(),a.fn.columns=function(b){function c(a,b){a.style.removeProperty?a.style.removeProperty(b):a.style.removeAttribute(b)}function d(b){b=b||{};var c=this,d={namespace:"columns",height:c.height(),width:c.width(),top:c.offset().top,left:c.offset().left,win:m.height(),winW:m.width(),gutterTop:0,cols:4,columnHeights:[],columnTemplate:'<div class="column">{{ content }}</div>',autoWidth:!0,createColumns:!0,proportionalScroll:!1,reverse:!1,reversedDirection:!1,requestFrame:!0},h=c.children(),i=h.length,k=0,l=[],n=0,o="";if(b.filter=b.filter||!1,a.extend(d,b),d.createColumns){for(d.oldHTML=c[0].innerHTML,k=0;i>k;k++)l[n]=(l[n]||"")+h[k].outerHTML,n++,n===d.cols&&(n=0);for(k=0;k<d.cols;k++)l[k]=l[k]||"",o+=d.columnTemplate.replace("{{ content }}",l[k]);c.html(o),d.columns=c.find(".column")}else d.columns=c.children();return c.data("settings",d),window.requestAnimationFrame&&d.requestFrame?(m.on("scroll."+d.namespace,this,f).on("resize."+d.namespace,this,e).on("touchmove."+d.namespace,this,f).trigger("scroll").trigger("resize"),e(),f(),g()):(m.on("scroll."+d.namespace,this,g).on("resize."+d.namespace,this,e).on("touchmove."+d.namespace,this,g).trigger("scroll").trigger("resize"),e(),g()),j=setTimeout(e,2e3),c}function e(){if(h.length){var a=h,b=a.data("settings"),c=0,d=0,e=0,g={left:0};if(b){for(b.width=a.width(),b.top=a.offset().top,b.left=a.offset().left,b.win=m.height(),b.winW=m.width(),b.autoWidth&&(g.width=b.width/b.cols+"px"),c=0;c<b.cols;c++)b.columns.eq(c).removeAttr("style").removeClass("is-fixed").removeClass("is-short"),g.marginLeft=e,b.columns.eq(c).css(g),b.columnHeights[c]=b.columns.eq(c).height()+b.gutterTop,d=Math.max(b.columnHeights[c],d),e+=b.columns.eq(c).width();a.height(d),b.height=d,a.data("settings",b),f.call(a,{data:[a]})}}}function f(){l=!0,clearTimeout(k),k=setTimeout(function(){l=!1})}function g(){var a=h,b=a.data("settings"),d=i.scrollY?window.scrollY:m.scrollTop(),e=0;if(b)if(window.requestAnimationFrame&&b.requestFrame&&requestAnimFrame(g),b.proportionalScroll){var f=1,j=0,k="",l=0;for(e=0;e<b.cols;e++)f=b.columnHeights[e]/b.height,1!==f&&(j=(1-f)*b.height*Math.min(1,Math.max(0,(d-b.top)/(b.height-b.win))),j=Math.round(j),k="translate3d(0px,"+j+"px, 0px)",(d-b.top)/(b.height-b.win)>1&&(k="none",l=j),b.columns.eq(e).css({transform:k,"-webkit-transform":k,"-moz-transform":k,"-ms-transform":k,top:l}))}else{if(d<b.top)return b.columns.removeClass("is-fixed").removeClass("is-top-fixed").removeClass("is-short").css({left:0,minHeight:0,top:b.gutterTop}),b.columns.each(function(a,b){c(b,"position")}),void a.removeClass("is-scrolled-past");if(d+b.win>b.top+b.height){for(b.columns.removeClass("is-fixed").removeClass("is-top-fixed").css({left:0,transform:"none","-webkit-transform":"none","-moz-transform":"none","-ms-transform":"none"}),e=0;e<b.cols;e++)b.columnHeights[e]<b.win&&b.columnHeights[e]<b.height&&b.columns.eq(e).css(d+b.columnHeights[e]>b.top+b.height?{top:"auto",bottom:0,position:"absolute"}:{position:"fixed",top:b.gutterTop,left:b.left});return void a.addClass("is-scrolled-past")}if(a.removeClass("is-scrolled-past"),b.reverse)for(e=0;e<b.cols;e++)b.columnHeights[e]<b.win&&d>b.top?b.columns.eq(e).removeClass("is-bottom-fixed").addClass("is-short").css({left:b.left,top:0}):(b.columns.eq(e).removeClass("is-short").css({left:0,top:0}),d<b.top||(d>b.top+b.height-b.columnHeights[e]?b.columns.eq(e).removeClass("is-top-fixed").css({left:0,top:b.height-b.columnHeights[e]}):b.columnHeights[e]<b.height&&b.columns.eq(e).addClass("is-top-fixed").css({left:b.left})));else for(e=0;e<b.cols;e++)if(b.columnHeights[e]<b.win&&d>b.top)b.columns.eq(e).removeClass("is-fixed").addClass("is-short").css({left:b.left,transform:"none","-webkit-transform":"none","-moz-transform":"none","-ms-transform":"none",position:"fixed",top:b.gutterTop});else if(b.columns.eq(e).removeClass("is-short").css({left:0}),c(b.columns.eq(e).get(0),"position"),!(d<b.top))if(b.reversedDirection&&e%2!==0){var j=2*Math.max(d-b.top,0)+b.win-b.columnHeights[e];j=Math.round(j),j=Math.min(j,-b.win+b.height),k="translate3d(0px,"+j+"px, 0px)",b.columns.eq(e).css({transform:k,"-webkit-transform":k,"-moz-transform":k,"-ms-transform":k})}else d>b.top+b.columnHeights[e]+b.gutterTop-b.win?b.columns.eq(e).addClass("is-fixed").css({top:"auto",left:b.left}):b.columns.eq(e).removeClass("is-fixed").css({left:0})}}var h=this,i={scrollY:window.scrollY>=0?!0:!1},j=null,k=null,l=!1,m=(a(document),a("body"),a(window)),n={destroy:function(){var b=this.data("settings");b&&(b.createColumns&&(this[0].innerHTML=b.oldHTML,this[0].setAttribute("style","")),m.off("."+b.namespace),a(this).removeData("settings"),clearTimeout(j))},softDestroy:function(){var b=this.data("settings");b&&(m.off("."+b.namespace),a(this).removeData("settings"),clearTimeout(j))},update:function(b,c){var d=a(this),e=d.data("settings")||{};e[b]=c,d.data("settings",e)}};if("string"==typeof b&&b in n)return n[b].call(this,arguments.length>1?arguments.slice(1):arguments),h;return d.call(this,b)}}(window.jQuery||window.Zepto);